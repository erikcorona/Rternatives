#include "Hypothesis.hxx"
#include <iostream>
#include <CoOccurTest.hxx>
#include <CorTest.hxx>
#include <ks.hxx>

using namespace std;

std::vector<double> aaa = {0.92062, 0.92062, 0.92062, 0.92062, 0.98921, 0.98921, 0.98921, 0.98921};
//std::vector<double> bbb = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1e-05, 1e-05, 2e-05, 4e-05, 4e-05, 7e-05, 8e-05, 9e-05, 9e-05, 9e-05, 0.0001, 0.0001, 0.00015, 0.00015, 0.00017, 0.00029, 0.00031, 0.00036, 0.00044, 0.00045, 0.00045, 0.00049, 0.00051, 0.00059, 0.00059, 0.0006, 0.00066, 0.00095, 0.00099, 0.00109, 0.00115, 0.00129, 0.00133, 0.00137, 0.00139, 0.00144, 0.0017, 0.00217, 0.00217, 0.00229, 0.00259, 0.00304, 0.00307, 0.00316, 0.00379, 0.0039, 0.00416, 0.00448, 0.00452, 0.00458, 0.00518, 0.00532, 0.0057, 0.00594, 0.0069, 0.00736, 0.00736, 0.00736, 0.00739, 0.00804, 0.00814, 0.0085, 0.00951, 0.01002, 0.01003, 0.01158, 0.01192, 0.01192, 0.01244, 0.01379, 0.01465, 0.015, 0.01606, 0.01644, 0.0182, 0.01837, 0.01932, 0.01944, 0.01956, 0.02055, 0.02167, 0.02323, 0.02639, 0.02639, 0.02684, 0.02981, 0.03044, 0.03105, 0.03203, 0.03234, 0.03273, 0.03317, 0.03799, 0.03802, 0.03814, 0.04002, 0.04106, 0.04163, 0.04262, 0.04444, 0.04729, 0.04778, 0.04931, 0.04998, 0.05045, 0.05122, 0.0513, 0.05318, 0.05499, 0.05671, 0.05895, 0.05896, 0.06162, 0.06314, 0.06361, 0.06394, 0.06537, 0.06548, 0.06806, 0.07918, 0.08101, 0.0818, 0.08211, 0.08247, 0.08394, 0.08736, 0.08743, 0.08766, 0.08861, 0.09156, 0.09161, 0.09326, 0.09387, 0.09541, 0.09731, 0.09925, 0.10716, 0.10716, 0.108, 0.11078, 0.11435, 0.11451, 0.11486, 0.11803, 0.12169, 0.12629, 0.12745, 0.12767, 0.1299, 0.13158, 0.13462, 0.14009, 0.14142, 0.14243, 0.14324, 0.14471, 0.14718, 0.15774, 0.15783, 0.15855, 0.16191, 0.16232, 0.16266, 0.16851, 0.16942, 0.17083, 0.17451, 0.17597, 0.1761, 0.17812, 0.17838, 0.18162, 0.1829, 0.18458, 0.18562, 0.18571, 0.18598, 0.19154, 0.19201, 0.19239, 0.19347, 0.20191, 0.21853, 0.22066, 0.22131, 0.22243, 0.22331, 0.22772, 0.23018, 0.23444, 0.24141, 0.24297, 0.24539, 0.24702, 0.24755, 0.25226, 0.25589, 0.25936, 0.2636, 0.26477, 0.26489, 0.27254, 0.27695, 0.27723, 0.27867, 0.28262, 0.28818, 0.28846, 0.29059, 0.29457, 0.30195, 0.3058, 0.30609, 0.30873, 0.31297, 0.31661, 0.31661, 0.31769, 0.31844, 0.32181, 0.32572, 0.32757, 0.32811, 0.32811, 0.33557, 0.33853, 0.33954, 0.34116, 0.36762, 0.3677, 0.38018, 0.3971, 0.39952, 0.40792, 0.41472, 0.41569, 0.41724, 0.41817, 0.42398, 0.4244, 0.43721, 0.44529, 0.45816, 0.45963, 0.46755, 0.46959, 0.47649, 0.47866, 0.48111, 0.48226, 0.49769, 0.50274, 0.50762, 0.51524, 0.52347, 0.54122, 0.54527, 0.56036, 0.57209, 0.57723, 0.57832, 0.57838, 0.57843, 0.57951, 0.58304, 0.59673, 0.60973, 0.61346, 0.62216, 0.62987, 0.63224, 0.63294, 0.63788, 0.63844, 0.63861, 0.64046, 0.6489, 0.65913, 0.66643, 0.69934, 0.70029, 0.70485, 0.70701, 0.70732, 0.70855, 0.71295, 0.71336, 0.71366, 0.71538, 0.71803, 0.72127, 0.72421, 0.72668, 0.73703, 0.73799, 0.74731, 0.76124, 0.76713, 0.77991, 0.78587, 0.79436, 0.81247, 0.81471, 0.81794, 0.83147, 0.84507, 0.84786, 0.85212, 0.8605, 0.86667, 0.871, 0.87176, 0.87898, 0.87959, 0.88247, 0.88427, 0.88634, 0.89634, 0.89794, 0.90611, 0.90709, 0.90802, 0.90897, 0.91357, 0.91371, 0.91879, 0.92421, 0.9248, 0.92954, 0.93463, 0.94036, 0.94935, 0.95642, 0.9601, 0.96033, 0.96674, 0.96963, 0.97023, 0.97888, 0.98019, 0.9874, 0.9902, 0.99579, 0.99665, 0.99902, 0.99903, 0.99942, 0.99977, 0.99989, 1, 1, 1, 1, 1, 1, 1};
std::vector<double> bbb = {0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1};

std::vector<double> a = {0.625329, 0.635445, 0.602764, 1.00506, 0.672335, 0.766172,
                         0.696412, 0.726962, 0.619788, 1.1757, 0.105458, 0.8419, 0.645791,
                         0.475804, 1.68914, 0.469972, 0.766656, 0.622648, 0.736087, 1.11726,
                         0.732062, 0.730947, 1.03301, 0.607398, 0.662204, 0.683966, 1.21779,
                         0.666663, 0.697025, 0.350155, 0.540905, 0.936271, 0.654595, 1.2049,
                         0.589095, 0.737931, 0.87548, 0.722693, 1.51393, 0.880236, 0.566892,
                         0.762604, 0.691701, 0.388039, 0.487881, 0.603619, 0.796786, 0.18756,
                         3.35024, 0.733221, 0.695941, 0.826594, 0.620269, 0.600595, 0.463154,
                         0.474531, 0.293535, 0.602764, 0.600354, 0.680483, 0.578643, 0.304923,
                         0.716782, 0.622527, 0.70624, 0.883208, 0.52139, 0.553981, 0.85085,
                         0.632713, 0.868278, 0.507556, 0.356348, 0.600354, 0.90017, 0.596622,
                         0.788314, 0.791093, 0.474531, 0.710172, 0.618709, 0.820023, 0.624498,
                         0.621244, 1.40986, 1.0815, 0.696585, 0.696585, 0.717059, 0.689623,
                         1.11318, 0.775795, 1.03823, 0.688841, 0.775925, 1.0631, 0.687776,
                         0.691701, 0.805026, 1.13879, 0.847803, 0.86642, 0.660808, 0.699436,
                         0.997271, 1.0043, 0.679605, 0.50824, 2.28936, 0.852716, 0.482303,
                         0.753116, 0.452752, 0.639049, 0.420127, 1.15436, 0.440875, 0.681025,
                         0.681025, 0.744368, 0.780599, 0.584803, 0.562176, 0.737894, 0.743403,
                         0.769961, 0.658298, 0.779825, 0.660683, 0.513438, 0.803938, 0.819215,
                         0.627774, 0.663451, 0.888786, 0.693813, 0.71916, 0.814412, 0.731372,
                         0.600355, 0.678849, 0.690324, 0.674557, 0.834906, 0.671574, 0.673797,
                         1.21779, 0.626045, 0.596282, 0.700435, 0.712857, 0.646503, 0.642431,
                         1.49368, 0.600877, 0.7986, 0.592406, 0.761506, 0.625512, 0.581309,
                         0.741414, 0.825417, 0.418701, 0.631901, 0.739451, 0.702748, 0.658179,
                         0.923058, 0.992623, 0.761062, 0.620461, 0.774563, 0.576016, 0.678849,
                         0.670247, 0.878822, 0.885886, 0.853347, 0.650564, 0.907903, 0.710088,
                         0.736841, 0.914807, 1.62956, 0.779737, 0.716965, 0.507471, 0.761229,
                         0.97068, 0.678325, 1.09798, 0.680027, 0.789256, 1.18598, 0.695718,
                         0.744727, 0.729569, 0.639, 1.87205, 0.637459, 1.21779, 0.620499,
                         0.707586, 0.692653, 0.573737, 0.589151, 1.13739, 0.191924, 0.571904,
                         1.43285, 0.581881, 0.509417, 0.592177, 0.631959, 0.596706, 0.593289,
                         0.567163, 0.258507, 0.587422, 0.755052, 0.668973, 0.994828, 0.606111,
                         0.819172, 0.382704, 1.4182, 0.704807, 0.670935, 0.720419, 1.38244,
                         0.664172, 0.146178, 0.631352, 0.653421, 0.689689, 0.176313, 0.693551,
                         0.644211, 0.650963, 0.658542, 0.725671, 0.602854, 0.616776, 0.733191,
                         0.789482, 0.617947, 0.827698, 0.92892, 0.61257, 0.78254, 0.827028,
                         0.700882, 2.15664, 0.709124, 0.452752, 0.703985, 0.717863, 0.562453,
                         0.784563, 0.970078, 0.948157, 0.655101, 0.643854, 0.633044, 0.970078,
                         1.023, 0.439161, 0.666779, 0.72675, 0.669666, 0.8593, 0.832806,
                         0.677869, 0.785789, 1.46998, 0.662204, 0.688581, 0.703316, 0.747271,
                         0.926643, 0.668077, 0.701739, 0.653452, 0.67239, 1.09326, 0.839968,
                         2.21449, 0.70685, 0.564014, 0.760506, 1.21115, 0.789276, 0.892237,
                         0.899014, 0.515678, 0.978992, 0.584803, 1.08818, 0.635121, 0.676083,
                         1.35652, 1.0815, 0.639049, 0.768959, 0.833244, 0.447882, 0.744727,
                         1.12109, 0.571065, 0.741744, 0.172503, 0.525434, 0.692492, 0.77383,
                         0.643211, 0.989019, 0.746856, 0.704978, 0.250788, 0.71437, 1.00932,
                         0.672925, 0.588306, 1.82677, 1.27126, 0.68164, 0.736087, 0.0112726,
                         0.0809082, 0.911031, 1.0578, 0.63346, 1.2004, 0.699596, 0.699418,
                         0.213755, 0.885193, 0.603987, 0.640881, 0.905681, 0.54659, 1.66127,
                         1.40932, 0.600017, 0.852833, 0.856796, 0.673598, 0.382704, 1.67224,
                         0.746946, 0.909122, 0.395225, 0.870864, 0.701497, 1.02429, 1.65023,
                         0.628846, 0.750117, 0.378817, 1.03823, 1.21115, 0.556594, 0.595454,
                         0.79931, 0.999179, 0.727864, 0.285581, 0.829537, 1.44559, 0.544922,
                         0.616638, 1.16282, 0.716369, 0.885882, 0.610539, 0.626819, 0.358985,
                         0.585657, 0.807198, 1.28786, 0.47058, 0.741744, 0.925825, 0.572142,
                         0.715252, 1.29233, 1.66127, 0.731975, 0.567163, 0.562975, 1.28786,
                         2.00165, 0.684564, 0.672335};
std::vector<double> bb = {0.781633, 0.634801, 0.796639, 0.687056, 0.643347, 0.707099,
                         0.632251, 0.556426, 0.461708, 0.804052, 0.514278, 1.13591, 0.656124,
                         0.619886, 0.759166, 0.820578, 0.634227, 0.683927, 0.826882, 0.767646,
                         0.562013, 0.689778, 0.616498, 0.761949, 0.629622, 0.657822, 1.21178,
                         0.782663, 0.698844, 0.652011, 0.632295, 0.545358, 0.823944, 0.737213,
                         0.306905, 0.638736, 0.665714, 0.786546, 0.710498, 0.711524, 0.556295,
                         0.599175, 0.737213, 0.388529, 0.55338, 0.515779, 0.668159, 0.584284,
                         1.05173, 0.61613, 0.599175, 0.738174, 0.776638, 0.644748, 0.800464,
                         0.670075, 0.564949, 0.803099, 0.72804, 0.586421, 0.811346, 0.468801,
                         0.696089, 0.756916, 0.737366, 0.607777, 0.684546, 0.708267, 0.958879,
                         0.667895, 0.826809, 0.83673, 0.520347, 0.864701, 0.599342, 0.739632,
                         0.439662, 0.674121, 0.670075, 0.659897, 0.767457, 0.51992, 0.51867,
                         0.724772, 0.831245, 0.647213, 0.610249, 0.610249, 0.600458, 0.591346,
                         0.651, 0.820533, 1.55567, 0.630933, 0.576495, 1.44613, 0.692111,
                         0.646386, 0.668034, 0.730964, 0.62345, 0.428823, 0.643494, 0.546166,
                         0.599642, 0.957805, 0.695713, 0.777019, 0.894417, 1.22755, 0.991293,
                         0.782885, 0.636184, 1.03521, 0.340773, 0.590725, 0.865687, 0.668091,
                         0.668091, 0.666951, 0.890261, 0.576089, 0.755812, 0.712743, 0.704791,
                         0.596529, 0.606584, 0.77993, 0.753076, 0.805677, 0.777054, 0.432291,
                         1.01741, 0.851006, 0.564455, 0.932405, 0.705559, 0.781275, 0.643108,
                         0.90486, 0.678332, 0.793145, 0.504287, 0.671544, 0.713007, 0.563309,
                         1.21178, 0.695427, 0.444741, 0.746246, 0.537729, 0.707912, 0.736225,
                         0.542529, 0.937742, 0.569533, 0.985233, 0.73098, 0.751134, 0.697596,
                         0.657941, 0.581247, 0.778769, 0.777458, 0.710816, 0.946274, 1.0292,
                         0.653511, 0.633886, 0.641463, 0.231692, 0.66225, 0.63825, 0.733355,
                         0.778163, 1.01189, 1.92322, 0.641544, 0.0218889, 0.796304, 0.398311,
                         0.718694, 1.14941, 0.805062, 0.847231, 0.703603, 0.663147, 0.730694,
                         0.959367, 0.718408, 0.869905, 0.705818, 0.989228, 0.737298, 0.680517,
                         0.661534, 0.767062, 0.944979, 0.582519, 0.704256, 1.21178, 0.750399,
                         0.608568, 0.528984, 0.780566, 0.724246, 0.942475, 0.846989, 1.37787,
                         0.881279, 0.672826, 0.499082, 0.712981, 0.762733, 0.95835, 0.70699,
                         0.710945, 1.5111, 0.741174, 0.67361, 0.611761, 0.864593, 0.722253,
                         1.00276, 0.14522, 1.03206, 0.825364, 0.648997, 0.975978, 1.03973,
                         2.21799, 1.24693, 0.811885, 0.790681, 0.682794, 1.15862, 0.698122,
                         0.605017, 0.688845, 0.84107, 0.649632, 0.615846, 0.943626, 0.73872,
                         0.723094, 0.629644, 0.870955, 0.633078, 0.769458, 0.816388, 0.552782,
                         0.697747, 1.34875, 0.634831, 0.636184, 0.753767, 0.691401, 0.668517,
                         0.702306, 0.314722, 0.88374, 0.675195, 0.657468, 0.708841, 0.314722,
                         1.3144, 0.899797, 0.944086, 0.827702, 0.848778, 0.792232, 0.630017,
                         0.880854, 0.689008, 0.89252, 0.629622, 0.834575, 0.827979, 0.823876,
                         0.87867, 0.746243, 0.690482, 0.751823, 0.701384, 1.04993, 0.656872,
                         1.12049, 0.542305, 0.535149, 0.362504, 0.64731, 0.814941, 0.855813,
                         0.828628, 0.738338, 0.857432, 0.576089, 0.899081, 0.768056, 0.642231,
                         0.595093, 0.647213, 1.03521, 0.788595, 0.651287, 0.919908, 0.661534,
                         0.829882, 1.15294, 0.74155, 0.197823, 0.781572, 0.534206, 0.599964,
                         0.809127, 0.593313, 0.6188, 0.707532, 0.963569, 0.704461, 0.886958,
                         0.686439, 0.655091, 1.66032, 0.222647, 0.664439, 0.826882, 1.55298,
                         0.923803, 0.768128, 0.736419, 0.524177, 0.853897, 0.455502, 0.784114,
                         0.600369, 0.71401, 0.604371, 0.567048, 0.723581, 0.749768, 0.721802,
                         2.15243, 0.625364, 0.855318, 0.304343, 1.0026, 0.14522, 0.794862,
                         0.663061, 0.681614, 0.594936, 0.745684, 0.587291, 0.810207, 1.17794,
                         0.70213, 0.898142, 0.608971, 1.55567, 0.64731, 0.440158, 0.63124,
                         1.28161, 0.313504, 0.763289, 0.125781, 0.733366, 0.330012, 0.622412,
                         0.852978, 0.915597, 0.0852646, 0.645858, 0.871913, 0.752014,
                         0.48085, 0.437, 0.710581, 0.618709, 0.710517, 0.74155, 0.936652,
                         0.63299, 0.635177, 2.12727, 0.721802, 0.582728, 0.608441, 0.677712,
                         0.618709, 1.94691, 0.492905, 0.643347};
void test1()
{
//    a = {1,2,3,3,4,5,6,7,7,3,2,4,56,2};
//    b = {11,22,13,33,64,15,2645,67,97,73,32,42,556,12};
    fastR::CorTest cor(a,bb);
    std::cerr << cor.tau_b() << " / ";
//    std::cerr << cor.pValue(fastR::greater) << " / ";
    std::cerr << cor.z_b() << " / " << cor.p_b(fastR::alternative::greater) << std::endl;

}

void testks()
{
//    auto res2 = kstest2sample (a.begin(), a.end(), bb.begin(), bb.end(), fastR::greater,false);
//    std::cerr << res2.statistic << " " << res2.pValue << " " << res2.method << std::endl;
//
//    std::cerr << "TEST2" << std::endl;
    auto res22 = kstest2sample (aaa.begin(), aaa.end(), bbb.begin(), bbb.end(), fastR::two_tailed,true);
    std::cerr << res22.statistic << " " << res22.pValue << " " << std::endl;
}

int main()
{
    clock_t t1,t2;
    t1 = clock();
    test1();
    t2 = clock();
    float diff ((float)t2-(float)t1);
    float seconds = diff / CLOCKS_PER_SEC;
    std::cout << "Runtime: " << seconds << "s" << std::endl;
    testks();
//    fastR::CoOccurTest co(30,30,10,20);

//    std::vector<double> a = {  95,3,6,77,23,1,335,13,37, 18, 29};
//    std::vector<double> b = {952,13,2,37,33,11,332,82,7, 8, 9};

//    std::cout << a.size() << std::endl;
//    fastR::CorTest cor(a,b);
//    cout << "co: " << co.oddsRatio() << endl;
//    cout << "cor: " << cor.tau_a() << endl;

//    std::vector<double> aa = {23,23,27,27,39,41,45,49,50,53,53,54,56,57,58,58,60,61};
//    std::vector<double> bb = {9.5,27.9,7.8,17.8,31.4,25.9,27.4,25.2,31.1,34.7,42.0,29.1,32.5,30.3,33.0,33.8,41.1,34.5};

//    fastR::CorTest cor2(aa,bb);
//    cout << "cor2a: " << cor2.tau_a() << endl;
//    cout << "cor2b: " << cor2.tau_b() << endl;
//    cout << "cor2b-p: " << cor2.pValue(fastR::greater) << endl;
    return 0;
}